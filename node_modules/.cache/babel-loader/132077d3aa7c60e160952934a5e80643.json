{"ast":null,"code":"import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _defineProperty from\"/home/burslf/ITC/SKIN/SkinAI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/burslf/ITC/SKIN/SkinAI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/burslf/ITC/SKIN/SkinAI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{faArrowLeft,faCamera,faToggleOn,faToggleOff}from'@fortawesome/free-solid-svg-icons';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import axios from'axios';import{useEffect,useRef,useState,useContext}from'react';import{Form,Button,Dropdown,Row}from'react-bootstrap';import{Spinner}from'reactstrap';import{useHistory}from\"react-router-dom\";import'./UploadForm.css';import{Redirect}from'react-router';import{itemUploaded,formImageIssue,displayFormDoctorImage,redirecting}from'../../Tools/WebsiteResponses';import ModalDoctorDisplay from'./ModalDoctorDisplay.png';import ImageCrop from'../ImageCrop/ImageCrop';import{Authentication}from\"../../Contexts/Authentication\";import url from'../../Tools/URLs';var UploadForm=function UploadForm(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),infos=_useState2[0],setInfos=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),dropdownOpen=_useState4[0],setDropdownOpen=_useState4[1];var _useState5=useState({selectedFile:null}),_useState6=_slicedToArray(_useState5,2),pic=_useState6[0],setPic=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),previewPic=_useState8[0],setPreviewPic=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),redirect=_useState10[0],setRedirect=_useState10[1];// in case of success\nvar _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState('bold'),_useState14=_slicedToArray(_useState13,2),croppedImage=_useState14[0],setCroppedImage=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),sendEmail=_useState16[0],setSendEmail=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),nextForm=_useState18[0],goToNextForm=_useState18[1];var _useContext=useContext(Authentication),isLogged=_useContext.isLogged,setIsLogged=_useContext.setIsLogged;var toggle=function toggle(){return setDropdownOpen(function(prevState){return!prevState;});};var ref=useRef(null);var history=useHistory();var handleChange=function handleChange(e){setInfos(_objectSpread(_objectSpread({},infos),{},_defineProperty({},e.target.name,e.target.value)));};var imageUploadStyle={color:\"#434343\",fontSize:\"\".concat(previewPic?\"15px\":\"35px\")};var handleSelect=function handleSelect(e){setInfos(_objectSpread(_objectSpread({},infos),{},{category:e.target.name}));};var uploadForm=function uploadForm(e){setLoading(true);e.preventDefault();var data=new FormData();for(var key in infos){data.append(key,infos[key]);}if(pic.selectedFile){data.append('user',localStorage.getItem('sessionID'));var img=pic.selectedFile;if(croppedImage){img=croppedImage;}data.append('image',img);}redirecting();axios.post(\"\".concat(url,\"/upload-image\"),data).then(function(res){itemUploaded('Image Uploaded');setLoading(false);history.push({pathname:'/Prediction',state:{data:res.data}});}).catch(function(err){formImageIssue(\"There was an issue uploading your image\");setLoading(false);});};useEffect(function(){displayFormDoctorImage(ModalDoctorDisplay);},[]);var imageUploader=function imageUploader(e){var file=e.target.files[0];var reader=new FileReader();reader.onload=function(e){//console.log(e.target.result)\nsetPreviewPic(e.target.result);};reader.readAsDataURL(file);setPic({selectedFile:e.target.files[0]});};var goToPreviousForm=function goToPreviousForm(image){setCroppedImage(image);goToNextForm(false);};if(redirect){return/*#__PURE__*/_jsx(Redirect,{to:url});}return/*#__PURE__*/_jsx(\"div\",{className:\"my-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"upload-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"instructions\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"1. Keep the spot in the absolute middle of the picture.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"2. Make sure the quality of the picture is good enough.\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h5\",{children:\"3. Do not take a picture in a dark environment.\"})]}),/*#__PURE__*/_jsxs(Form,{action:\"\",name:\"image\",className:\"upload-form\",onSubmit:function onSubmit(e){return uploadForm(e);},method:\"post\",enctype:\"multipart/form-data\",children:[!nextForm&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"image\",ref:ref,id:\"hidden\",onChange:function onChange(e){return imageUploader(e);}}),/*#__PURE__*/_jsx(\"div\",{className:\"image-upload\",style:{width:\"\".concat(previewPic?\"45px\":\"90px\"),height:\"\".concat(previewPic?\"45px\":\"90px\")},onClick:function onClick(){return ref.current.click();},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{style:imageUploadStyle,icon:faCamera})}),previewPic&&/*#__PURE__*/_jsx(\"div\",{className:\"image-preview\",children:/*#__PURE__*/_jsx(ImageCrop,{haveCropped:croppedImage&&croppedImage,src:previewPic,setImage:setCroppedImage})}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return goToNextForm(true);},children:\" Next \"})]}),nextForm&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',alignSelf:'flex-start',marginLeft:'20px',cursor:'pointer'},onClick:function onClick(){return goToPreviousForm();},children:[\" \",/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faArrowLeft,size:\"2x\"}),\" \"]}),/*#__PURE__*/_jsx(Form.Control,{className:\"upload-input\",name:\"name\",placeholder:\"Name\",onChange:function onChange(e){return handleChange(e);},value:infos&&infos.name&&infos.name}),/*#__PURE__*/_jsx(Form.Control,{className:\"upload-input\",type:\"number\",name:\"age\",placeholder:\"Age\",onChange:function onChange(e){return handleChange(e);},value:infos&&infos.age&&infos.age}),/*#__PURE__*/_jsxs(Dropdown,{isOpen:dropdownOpen,toggle:toggle,children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{caret:true,children:infos&&infos.category||'Gender'}),/*#__PURE__*/_jsxs(Dropdown.Menu,{align:\"right\",children:[/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(e){return handleSelect(e);},name:\"Male\",children:\" Male \"}),/*#__PURE__*/_jsx(Dropdown.Item,{onClick:function onClick(e){return handleSelect(e);},name:\"Female\",children:\" Female \"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"send-email\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\" Recieve the result by e-mail ?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cstm-checkbox\",children:[!sendEmail&&/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faToggleOff,size:\"2x\",onClick:function onClick(){setInfos(_objectSpread(_objectSpread({},infos),{},{sendemail:true}));setSendEmail(true);}}),sendEmail&&/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faToggleOn,size:\"2x\",onClick:function onClick(){setInfos(_objectSpread(_objectSpread({},infos),{},{sendemail:false}));setSendEmail(false);}})]}),sendEmail&&!isLogged&&/*#__PURE__*/_jsx(Form.Control,{className:\"email-input\",required:sendEmail,type:\"e mail\",name:\"email\",placeholder:\"Enter your e-mail\",onChange:function onChange(e){return handleChange(e);},value:infos&&infos.email&&infos.email})]}),!loading?/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\" Submit \"}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-1\",children:/*#__PURE__*/_jsx(Spinner,{className:\"mt-4 mb-3\",color:\"secondary\"})})]})]})]})});};export default UploadForm;","map":{"version":3,"sources":["/home/burslf/ITC/SKIN/SkinAI/src/Components/UploadForm/UploadForm.jsx"],"names":["faArrowLeft","faCamera","faToggleOn","faToggleOff","FontAwesomeIcon","axios","useEffect","useRef","useState","useContext","Form","Button","Dropdown","Row","Spinner","useHistory","Redirect","itemUploaded","formImageIssue","displayFormDoctorImage","redirecting","ModalDoctorDisplay","ImageCrop","Authentication","url","UploadForm","infos","setInfos","dropdownOpen","setDropdownOpen","selectedFile","pic","setPic","previewPic","setPreviewPic","redirect","setRedirect","loading","setLoading","croppedImage","setCroppedImage","sendEmail","setSendEmail","nextForm","goToNextForm","isLogged","setIsLogged","toggle","prevState","ref","history","handleChange","e","target","name","value","imageUploadStyle","color","fontSize","handleSelect","category","uploadForm","preventDefault","data","FormData","key","append","localStorage","getItem","img","post","then","res","push","pathname","state","catch","err","imageUploader","file","files","reader","FileReader","onload","result","readAsDataURL","goToPreviousForm","image","width","height","current","click","position","alignSelf","marginLeft","cursor","age","sendemail","email"],"mappings":"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","sourcesContent":["import { faArrowLeft, faCamera,faToggleOn, faToggleOff } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport axios from 'axios';\nimport { useEffect, useRef, useState, useContext } from 'react'\nimport { Form, Button, Dropdown, Row } from 'react-bootstrap'\nimport { Spinner } from 'reactstrap';\nimport { useHistory } from \"react-router-dom\";\nimport './UploadForm.css'\nimport { Redirect } from 'react-router'\nimport { itemUploaded, formImageIssue, displayFormDoctorImage,redirecting } from '../../Tools/WebsiteResponses';\nimport ModalDoctorDisplay from './ModalDoctorDisplay.png';\nimport ImageCrop from '../ImageCrop/ImageCrop';\nimport { Authentication } from \"../../Contexts/Authentication\";\nimport url from '../../Tools/URLs';\n\n\nconst UploadForm = () => {\n    const [infos, setInfos] = useState(null)\n    const [dropdownOpen, setDropdownOpen] = useState(false);\n    const [pic, setPic] = useState({ selectedFile: null })\n    const [previewPic, setPreviewPic] = useState(\"\")\n    const [redirect, setRedirect] = useState(false) // in case of success\n    const [loading, setLoading] = useState(false);\n    const [croppedImage, setCroppedImage] = useState('bold');\n    const [sendEmail, setSendEmail] = useState(false)\n    const [nextForm, goToNextForm] = useState(false)\n    const {isLogged, setIsLogged} = useContext(Authentication) \n \n    const toggle = () => setDropdownOpen(prevState => !prevState);\n\n    const ref = useRef(null)\n    const history = useHistory();\n    const handleChange = (e) => {\n        setInfos({\n            ...infos,\n            [e.target.name]: e.target.value\n        })\n    }\n\n    const imageUploadStyle = {\n        color: \"#434343\",\n        fontSize: `${previewPic ? `15px` : `35px`}`,\n    }\n\n    const handleSelect = (e) => {\n        setInfos({ ...infos, category: e.target.name })\n    }\n\n    const uploadForm = (e) => {\n        setLoading(true);\n        e.preventDefault()\n        const data = new FormData()\n        for (let key in infos) {\n            data.append(key, infos[key])\n        }\n        if (pic.selectedFile) {\n            data.append('user', localStorage.getItem('sessionID'));\n            let img = pic.selectedFile;\n            if (croppedImage) {\n                img = croppedImage;\n            }\n            data.append('image', img);\n        }\n        redirecting();\n        axios.post(`${url}/upload-image`, data)\n            .then((res) => {\n                itemUploaded('Image Uploaded'); \n                setLoading(false)\n                history.push({\n                    pathname: '/Prediction',\n                    state: {data: res.data}\n                })\n            })\n            .catch(err => { formImageIssue(\"There was an issue uploading your image\"); setLoading(false)});\n    }\n\n    useEffect(() => {\n        displayFormDoctorImage(ModalDoctorDisplay);\n    }, [])\n\n    const imageUploader = (e) => {\n        const file = e.target.files[0]\n        const reader = new FileReader()\n        reader.onload = (e) => {\n            //console.log(e.target.result)\n            setPreviewPic(e.target.result)\n        }\n        reader.readAsDataURL(file)\n        setPic({ selectedFile: e.target.files[0] })\n    }\n\n    const goToPreviousForm = (image) => {\n        setCroppedImage(image)\n        goToNextForm(false)\n    }\n\n    if (redirect) {\n        return (\n            <Redirect to={url} />\n        )\n    }\n\n    return (\n        <div className='my-container'>\n            <div className='upload-container'>\n            <div className='instructions'>\n                        <h5 >1. Keep the spot in the absolute middle of the picture.</h5>\n                        <br />\n                        <h5>2. Make sure the quality of the picture is good enough.</h5>\n                        <br />\n                        <h5>3. Do not take a picture in a dark environment.</h5>\n                    </div>\n               <Form action=\"\" name=\"image\" className=\"upload-form\" onSubmit={e => uploadForm(e)} method=\"post\" enctype=\"multipart/form-data\">\n                    {!nextForm && \n                    <>\n                    <input type=\"file\" name=\"image\" ref={ref} id=\"hidden\" onChange={(e) => imageUploader(e)} />\n                    <div className=\"image-upload\" style={{width: `${previewPic ? `45px` : `90px`}`,height: `${previewPic ? `45px` : `90px`}`}}onClick={() => ref.current.click()}><FontAwesomeIcon style={imageUploadStyle} icon={faCamera} /></div>\n                   \n                       {previewPic && <div className=\"image-preview\">\n                            <ImageCrop\n                                haveCropped={croppedImage && croppedImage}\n                                src={previewPic}\n                                setImage={setCroppedImage}\n                            />\n                        </div>}\n\n                        <Button onClick={() => goToNextForm(true)}> Next </Button>\n                        \n                        </>}\n\n                        {nextForm && \n                        <>\n                        <div style={{position: 'relative', alignSelf: 'flex-start', marginLeft: '20px', cursor: 'pointer'}} onClick={() => goToPreviousForm()}> <FontAwesomeIcon icon={faArrowLeft} size=\"2x\"/> </div>\n                         <Form.Control className=\"upload-input\" name=\"name\" placeholder=\"Name\" onChange={e => handleChange(e)} value={(infos && infos.name) && infos.name}/>\n                    <Form.Control className=\"upload-input\" type=\"number\" name=\"age\" placeholder=\"Age\" onChange={e => handleChange(e)} value={(infos && infos.age) && infos.age}/>\n                    <Dropdown isOpen={dropdownOpen} toggle={toggle}>\n                        <Dropdown.Toggle caret>{(infos && infos.category) || 'Gender'}</Dropdown.Toggle>\n                        <Dropdown.Menu align='right'>\n                            <Dropdown.Item onClick={(e) => handleSelect(e)} name='Male'> Male </Dropdown.Item>\n                            <Dropdown.Item onClick={(e) => handleSelect(e)} name='Female'> Female </Dropdown.Item>\n                        </Dropdown.Menu>\n                    </Dropdown>\n                    <div className=\"send-email\">\n                        <h5> Recieve the result by e-mail ?</h5>\n                        <div className=\"cstm-checkbox\">\n                            {!sendEmail && <FontAwesomeIcon icon={faToggleOff} size='2x' onClick={() => {\n                                setInfos({...infos, sendemail : true})\n                                setSendEmail(true)\n                                }} />}\n                            {sendEmail && <FontAwesomeIcon icon={faToggleOn} size='2x' onClick={() => {\n                                setInfos({...infos, sendemail : false})\n                                setSendEmail(false)\n                                }} />}\n                        </div>\n                        {(sendEmail && !isLogged) && <Form.Control className=\"email-input\" required={sendEmail} type=\"e mail\" name=\"email\" placeholder=\"Enter your e-mail\" onChange={e => handleChange(e)} value={(infos && infos.email) && infos.email}/>}\n                    </div>\n      \n                        {!loading ? <Button type=\"submit\"> Submit </Button> : <div className=\"mt-1\"><Spinner className=\"mt-4 mb-3\" color=\"secondary\" /></div>}\n                        </>}\n\n                        </Form>\n\n                   \n\n            </div>\n        </div>\n    )\n}\n\nexport default UploadForm"]},"metadata":{},"sourceType":"module"}